---
import Layout from '../../layouts/Layout.astro';
import { getAlleFahrzeuge, urlFor } from '../../lib/sanity';
import type { Fahrzeug } from '../../types/sanity';

const fahrzeuge: Fahrzeug[] = await getAlleFahrzeuge();
---

<Layout 
  title="Unsere Fahrzeuge | AHAM Automobile"
  description="Entdecken Sie unsere Auswahl an geprüften Gebrauchtwagen in Ludwigsfelde."
>
  <main>
    <h1>Unsere Fahrzeuge</h1>
    <p>{fahrzeuge.length} Fahrzeuge verfügbar</p>

    <div class="fahrzeuge-grid">
      {fahrzeuge.map((fahrzeug) => (
        <a href={`/fahrzeuge/${fahrzeug.slug}`} class="fahrzeug-card">
          <img 
            src={urlFor(fahrzeug.hauptbild).width(400).height(300).url()} 
            alt={`${fahrzeug.marke} ${fahrzeug.modell}`}
          />
          <h2>{fahrzeug.marke} {fahrzeug.modell}</h2>
          <p>{fahrzeug.baujahr} • {fahrzeug.kilometerstand?.toLocaleString('de-DE')} km</p>
          <p class="preis">{fahrzeug.preis?.toLocaleString('de-DE')} €</p>
        </a>
      ))}
    </div>
  </main>
</Layout>

<style>
  .fahrzeuge-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
    padding: 2rem;
  }
  
  .fahrzeug-card {
    text-decoration: none;
    color: inherit;
  }
  
  .fahrzeug-card img {
    width: 100%;
    height: auto;
  }
  
  .preis {
    font-size: 1.5rem;
    font-weight: bold;
  }
</style>